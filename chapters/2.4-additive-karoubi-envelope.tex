\section{Additive Karoubi Envelope}
\label{sec:additive-karoubi}

Many interesting categories in representation theory are equivalent to categories of modules over a ring or an algebra. Accordingly, the notion of indecomposable representations, or modules with no non-trivial direct summands, come up in various problems. However the diagrammatic monoidal categories we will define may not innately contain direct sums and direct summands, so we must formally add them in. This can be done by taking the additive closure and Karoubi envelope.

\subsection*{Additive and Karoubian Categories}
% tilt 4.1

\begin{definition}
    A \textit{preadditive category} is a category enriched over the category of abelian groups. That is, for objects $A$ and $B$, $\Hom(A,B)$ has the structure of an abelian group such that the composition of morphisms is bilinear over the abelian group operation.
\end{definition}

In particular, $R$-linear categories are preadditive because $R$-modules are defined over abelian groups.

\begin{definition}
    A \textit{biproduct} of objects of a category is an object that is both a product and a coproduct.
    An \textit{additive category} is a preadditive category that admits all finite biproducts.
\end{definition}

Biproducts are a generalisation of direct sums of modules, so we often write $\oplus$ and say ``direct sum''. In other words, additive categories are preadditive categories containing all direct sums. An easy example is the category of modules over a ring $R$.

\begin{definition}
    An \textit{idempotent} is a endomorphism $e$ such that $e \circ e = e$.
    We say that a preadditive category is \textit{Karoubian} or \textit{idempotent complete} if for every idempotent $e: X \to X$ there is a direct sum decomposition $X \cong Y \oplus Z$ such that $e$ is a projection onto the component $Y$.
\end{definition}

This is a formal way to say that a category contains all direct summands, as every direct summand is an image of an idempotent given by projection.




\subsection*{Additive Closure and Karoubi Envelope}

The additive closure and Karoubi envelope are formal constructions that add direct sums and direct summands into a preadditive category. We will see applications of these in \autoref{chapter:one-col-diagrammatics} and \autoref{chapter:two-col-diagrammatics}.

\begin{definition}
    Let $\mcal{C}$ be a preadditive category. The \textit{additive closure} $\mcal{C}^\oplus$ of $\mcal{C}$ is the category where objects are finite (possibly empty) formal direct sums $\bigoplus_{i=1}^n A_i$ for $A_i \in \op{ob}(\mcal{C})$. We call the empty direct sum the \textit{zero object} $0$. A morphism $f$ of $\Hom_{\mcal{C}^\oplus}(\bigoplus_{i=1}^n A_i, \bigoplus_{i=1}^m B_i)$ is an $m \times n$ matrix $f = (f_{j,i})$ of morphisms $f_{j,i} \in \Hom_\mcal{C}(A_i, B_j)$.
\end{definition}

% The additive closure is sometimes denoted by $\cat{Mat}(\mcal{C})$.
It is clear that $\mcal{C}$ is a category that embeds in $\mcal{C}^\oplus$ and that $\mcal{C}^\oplus$ is additive. In the case where $\mcal{C}$ is monoidal, $\mcal{C}^\oplus$ is monoidal by extending the monoidal product to be an additive functor in each input. If $\mcal{C}$ is $R$-linear, then $\mcal{C}$ is an $R$-linear category by assuming that the $R$-action on morphisms applies componentwise. Lastly, if $\mcal{C}$ is a $\mcal{M}$-module category, then $\mcal{C}$ is a $\mcal{M}$-module category by additionally assuming that the module action applies componentwise.

\begin{lemma}
    The additive closure satisfies the following universal property. For every preadditive functor $F: \mcal{C} \to \mcal{D}$ where $\mcal{D}$ is an additive category, there is a unique additive functor $F': \mcal{C}^\oplus \to \mcal{D}$ such that the composition $\mcal{C} \hookrightarrow \mcal{C}^\oplus \xto{F'} \mcal{D}$ is $F$.
\end{lemma}

This is a classical result so we will not provide a proof. It can be observed by extending $F$ to a functor $F^\oplus: \mcal{C}^\oplus \to \mcal{D}^\oplus$ defined by applying $F$ componentwise.

\begin{definition}
    Let $\mcal{C}$ be a category. The \textit{Karoubi envelope} $\op{Kar}(\mcal{C})$ of $\mcal{C}$ is the category where objects are ordered pairs $(A,e)$ for an object $A$ in $\mcal{C}$ and an idempotent $e \in \End_\mcal{C}(A)$.  Morphisms $f: (A, e) \to (A', e')$ are morphisms $f:A \to A'$ in $\mcal{C}$ such that $f = f \circ e = e' \circ f$, where composition is composition in $\mcal{C}$. Equivalently, morphisms $f: (A, e) \to (A', e')$ are of the form $e'\circ f \circ e$ for some (not necessarily unique) morphism $f: A \to A'$. The identity morphism on $(A,e)$ is $e$.
\end{definition}

This is also known as the \textit{Karoubian closure} or \textit{idempotent completion}. We should think of the objects $(A,e)$ as ``the image of $e$''.

\begin{proposition}
    For a preadditive category $\mcal{C}$, $\op{Kar}(\mcal{C})$ is Karoubian.
\end{proposition}

A proof can be found in \cite[Lemma 11.17]{intro-soergel-bimodules}.

\begin{lemma}
    Every functor $F: \mcal{C} \to \mcal{D}$ where $\mcal{D}$ is Karoubian, extends uniquely (up to isomorphism) to a functor $F': \op{Kar}(\mcal{C}) \to \mcal{D}$.
\end{lemma}

This is another classical result. See \cite[Proposition 6.5.9 (1)]{borceux-categorical-algebra} for a proof.

The structure of monoidal, $R$-linear, $\mcal{M}$-module or additive categories, or a combination thereof, can be naturally extended to its Karoubi envelope. If $\mcal{C}$ is monoidal, the monoidal product extends to $\op{Kar}(\mcal{C})$ by applying the monoidal product in $\mcal{C}$ componentwise. If $\mcal{C}$ is $R$-linear, then $\op{Kar}(\mcal{C})$ is naturally $R$-linear as morphisms are those of $\mcal{C}$ and composition in $\mcal{C}$ is $R$-linear. If $\mcal{C}$ is a module category over $\mcal{M}$, then the $\mcal{M}$-action can be extended to $\op{Kar}(\mcal{C})$ such that $M \odot (A,e) = (M \odot A, \id_M \odot e)$, where $\id_M \odot e$ is an idempotent by bifunctoriality of $\odot$. We can similarly extend $\op{Kar}(\mcal{M})$ to a module category over $\op{Kar}(\mcal{M})$. Finally if $\mcal{C}$ is additive, then $\op{Kar}(\mcal{C})$ is additive by applying direct sums componentwise. The \textit{additive Karoubi envelope} of a preadditive category $\mcal{C}$ is the idempotent complete additive category $\op{Kar}(\mcal{C}^\oplus)$ which we may denote $\Kar(\mcal{C})$.

For diagrammatic monoidal categories $\mcal{C}$, its additive closure has an easy diagrammatic description by matrices of diagrams. However, in general, diagrams for $\op{Kar}(\mcal{C})$ or $\Kar(\mcal{C})$ are not so simple, since we need to identify every idempotent and place them around morphisms.

\begin{definition}
    An additive category is \textit{Krull--Schmidt} if every object decomposes into a finite direct sum of objects with local endomorphism rings.
\end{definition}

Particularly, all objects decompose into a finite direct sum of indecomposables. The additive Karoubi envelope is not Krull--Schmidt in general. However by results in \cite[Secition 11.3 Appendix 1]{intro-soergel-bimodules}, the additive Karoubi envelope, over the $\Bbbk$-linear diagrammatic categories we will work with, are Krull--Schmidt.

